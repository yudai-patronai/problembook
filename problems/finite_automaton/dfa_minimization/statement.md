---
id: 844023ff-809d-402b-9270-e1c9bfbaeb42
longname: Минимазация DFA
languages: [cpp]
tags: [dfa]
checker: cmp_int
time_limit: 2
real_time_limit: 2
max_vm_size: 64M
---

Дан детерминированный конечный автомат (ДКА) А. Необходимо найти количество состояний в минимальном по количеству состояний ДКА, эквивалентном данному.

Гарантируется, что функция переходов А тотальна, то есть из любого состояния А по любому символу перехода произойдёт переход в валидное состояние, принадлежащее А.

Гарантируется, что не существует состояний, не достижимых из начального.

### Формат входных данных

Дано описание конечного автомата A.

На первой строке три числа через пробел. n, t, l. 1 <= n <= 1000 -- количество состояний автомата; 0 <= t <= n -- количество терминальных состояний; 1 <= l <= 26 -- количество букв в алфавите. Состояния пронумерованы от 0 до n-1, состояние с номером 0 является начальным.

На второй строке t чисел от 0 до n-1 -- номера терминальных состояний.

На следующих n * l строках даны переходы в виде "s1 b s2", где s1 -- номер начального состояния, b -- символ перехода, s2 -- номер конечного состояния. Номера состояний от 0 до n-1, символ перехода -- строчная буква латинского алфавита. Для данного l используются только первые l букв английского алфавита. Все эти строки различны и могут быть перечислены в произвольном порядке.

### Формат выходных данных

Одно число — количество состояний в минимальном по количеству состояний детерминированном конечном автомате, эквивалентном данному.

### Примеры

```
-> 4 1 2
-> 2
-> 0 a 1
-> 0 b 0
-> 1 a 1
-> 1 b 2
-> 2 a 3
-> 2 b 3
-> 3 a 3
-> 3 b 3
--
<- 4
```

```
-> 4 1 2
-> 3
-> 0 a 1
-> 0 b 2
-> 1 a 1
-> 1 b 3
-> 2 a 2
-> 2 b 3
-> 3 a 3
-> 3 b 3
--
<- 3
```
